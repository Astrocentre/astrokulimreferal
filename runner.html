<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Advanced Endless Runner</title>
<style>
  html, body {
    margin: 0; padding: 0; overflow: hidden; height: 100%;
    background: #87ceeb;
    font-family: 'Arial', sans-serif;
  }
  canvas {
    display: block;
  }
  #score {
    position: absolute;
    top: 10px; left: 50%;
    transform: translateX(-50%);
    color: white;
    font-size: 24px;
    font-weight: bold;
    text-shadow: 0 0 5px #000;
  }
</style>
</head>
<body>
<canvas id="game"></canvas>
<div id="score">Score: 0</div>
<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
let w, h;

function resize() {
  w = canvas.width = window.innerWidth;
  h = canvas.height = window.innerHeight;
}
window.addEventListener('resize', resize);
resize();

let groundHeight = 100;
let gravity = 0.6;
let gameSpeed = 6;
let score = 0;

const player = {
  x: 100,
  y: h - groundHeight - 50,
  width: 50,
  height: 50,
  dy: 0,
  jumpForce: 15,
  grounded: true,
  color: 'yellow'
};

const obstacles = [];

function spawnObstacle() {
  const size = 20 + Math.random() * 30;
  obstacles.push({
    x: w,
    y: h - groundHeight - size,
    width: size,
    height: size,
    color: 'red'
  });
}

function update() {
  player.dy += gravity;
  player.y += player.dy;

  if (player.y + player.height >= h - groundHeight) {
    player.y = h - groundHeight - player.height;
    player.dy = 0;
    player.grounded = true;
  }

  obstacles.forEach(ob => ob.x -= gameSpeed);
  
  obstacles.filter(ob => ob.x + ob.width > 0);

  score++;
  document.getElementById('score').textContent = `Score: ${Math.floor(score/10)}`;
}

function drawGround() {
  ctx.fillStyle = '#654321';
  ctx.fillRect(0, h - groundHeight, w, groundHeight);
}

function drawPlayer() {
  ctx.fillStyle = player.color;
  ctx.fillRect(player.x, player.y, player.width, player.height);
}

function drawObstacles() {
  obstacles.forEach(ob => {
    ctx.fillStyle = ob.color;
    ctx.fillRect(ob.x, ob.y, ob.width, ob.height);
  });
}

function gameLoop() {
  ctx.clearRect(0, 0, w, h);

  drawGround();
  drawPlayer();
  drawObstacles();

  update();

  requestAnimationFrame(gameLoop);
}

document.addEventListener('keydown', e => {
  if (e.code === 'Space' && player.grounded) {
    player.dy = -player.jumpForce;
    player.grounded = false;
  }
});

setInterval(spawnObstacle, 2000);

gameLoop();
</script>
</body>
</html>
