<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Advanced Endless Runner</title>
<style>
  html, body {
    margin: 0; padding: 0; overflow: hidden; height: 100%;
    background: linear-gradient(to top, #87ceeb, #ffffff);
    font-family: 'Arial', sans-serif;
  }
  canvas {
    display: block;
  }
  #score {
    position: absolute;
    top: 10px; left: 50%;
    transform: translateX(-50%);
    color: #fff;
    font-size: 24px;
    font-weight: bold;
    text-shadow: 0 0 5px #000;
  }
</style>
</head>
<body>
<canvas id="game"></canvas>
<div id="score">Score: 0</div>
<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
let w, h;

function resize() {
  w = canvas.width = window.innerWidth;
  h = canvas.height = window.innerHeight;
}
window.addEventListener('resize', resize);
resize();

let groundHeight = 100;
let gravity = 0.6;
let gameSpeed = 6;
let score = 0;

const player = {
  x: 100,
  y: h - groundHeight - 60,
  width: 60,
  height: 60,
  dy: 0,
  jumpForce: 15,
  grounded: true,
  color: '#FFD700'
};

const obstacles = [];

function spawnObstacle() {
  const size = 30 + Math.random() * 40;
  obstacles.push({
    x: w,
    y: h - groundHeight - size,
    width: size,
    height: size,
    color: '#FF4500'
  });
}

function update() {
  player.dy += gravity;
  player.y += player.dy;

  if (player.y + player.height >= h - groundHeight) {
    player.y = h - groundHeight - player.height;
    player.dy = 0;
    player.grounded = true;
  }

  obstacles.forEach(ob => ob.x -= gameSpeed);
  obstacles = obstacles.filter(ob => ob.x + ob.width > 0);

  score++;
  document.getElementById('score').textContent = `Score: ${Math.floor(score/10)}`;
}

function drawBackground() {
  const gradient = ctx.createLinearGradient(0, 0, 0, h);
  gradient.addColorStop(0, '#87ceeb');
  gradient.addColorStop(1, '#ffffff');
  ctx.fillStyle = gradient;
  ctx.fillRect(0, 0, w, h);
}

function drawGround() {
  ctx.fillStyle = '#654321';
  ctx.fillRect(0, h - groundHeight, w, groundHeight);
}

function drawPlayer() {
  ctx.fillStyle = player.color;
  ctx.fillRect(player.x, player.y, player.width, player.height);
  
  // Eye detail
  ctx.fillStyle = 'white';
  ctx.beginPath();
  ctx.arc(player.x + player.width - 20, player.y + 15, 8, 0, Math.PI * 2);
  ctx.fill();
  ctx.fillStyle = 'black';
  ctx.beginPath();
  ctx.arc(player.x + player.width - 22, player.y + 15, 4, 0, Math.PI * 2);
  ctx.fill();
}

function drawObstacles() {
  obstacles.forEach(ob => {
    ctx.fillStyle = ob.color;
    ctx.fillRect(ob.x, ob.y, ob.width, ob.height);
    ctx.fillStyle = 'rgba(0,0,0,0.15)';
    ctx.fillRect(ob.x + 5, ob.y + ob.height, ob.width - 10, 8);
  });
}

function gameLoop() {
  drawBackground();
  drawGround();
  drawPlayer();
  drawObstacles();

  update();

  requestAnimationFrame(gameLoop);
}

document.addEventListener('keydown', e => {
  if (e.code === 'Space' && player.grounded) {
    player.dy = -player.jumpForce;
    player.grounded = false;
  }
});

document.addEventListener('touchstart', () => {
  if (player.grounded) {
    player.dy = -player.jumpForce;
    player.grounded = false;
  }
}, { passive: true });

setInterval(spawnObstacle, 1500);

gameLoop();
</script>
</body>
</html>
